<tools>
  <tool name="waf_probe">
    <description>
      Initiates a smart analysis of a WAF-blocked endpoint. 
      Returns a list of heuristic mutation strategies that might bypass the filter.
      Use this when you receive a 403 Forbidden or 406 Not Acceptable.
    </description>
    <parameters>
      <parameter name="url" type="string" required="true">
        <description>The target URL that blocked the request.</description>
      </parameter>
      <parameter name="payload" type="string" required="true">
        <description>The original payload that was blocked.</description>
      </parameter>
      <parameter name="method" type="string" required="false">
        <description>HTTP method (GET/POST). Default: GET.</description>
      </parameter>
    </parameters>
  </tool>

  <tool name="mutate_payload">
    <description>
      Generates polymorphic variations of a payload using deterministic strategies.
      Strategies include: SQL_InlineComments, SQL_MixedCase, SQL_TabWhitespace, URL_DoubleEncoding, XSS_ImageOnerror, XSS_UnicodeEscape.
    </description>
    <parameters>
      <parameter name="payload" type="string" required="true">
        <description>The payload to mutate.</description>
      </parameter>
      <parameter name="strategy" type="string" required="false">
        <description>Specific strategy to apply or 'all'. Default: all.</description>
      </parameter>
    </parameters>
  </tool>

  <tool name="detect_waf_signature">
    <description>
      Analyzes HTTP response artifacts to identify the specific WAF vendor (Cloudflare, AWS, etc.).
    </description>
    <parameters>
      <parameter name="headers" type="dict" required="true">
        <description>Response headers from the blocked request.</description>
      </parameter>
      <parameter name="body" type="string" required="true">
        <description>Response body from the blocked request.</description>
      </parameter>
      <parameter name="status" type="integer" required="true">
        <description>HTTP status code (e.g., 403).</description>
      </parameter>
    </parameters>
  </tool>
</tools>
