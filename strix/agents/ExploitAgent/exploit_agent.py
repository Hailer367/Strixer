from typing import Any
from strix.agents.base_agent import BaseAgent
from strix.llm.config import LLMConfig

class ExploitAgent(BaseAgent):
    """
    Exploit Agent - Permanent specialized sub-agent for advanced exploitation.
    It has access to Metasploit, ExploitDB, and all security tools.
    Its purpose is to find, craft, and execute exploits against targets.
    """
    max_iterations = 500

    def __init__(self, config: dict[str, Any]):
        # Exploit Agent uses a broad set of security skills
        skills = ["exploit_master", "web_exploitation", "network_exploitation", "bypasses"]

        # Override the default LLM config
        self.default_llm_config = LLMConfig(skills=skills)

        super().__init__(config)

    async def run(self, initial_task: str) -> dict[str, Any]:
        """
        Start the Exploit Agent with an initial task.
        """
        return await self.agent_loop(task=initial_task)
